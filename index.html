<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Obstetricia ULagos</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff5f7;
      color: #333;
      padding: 20px;
      margin: 0;
    }
    h1 {
      text-align: center;
      color: #b71c1c;
    }
    .malla {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 16px;
      padding: 10px;
    }
    .semestre {
      min-width: 250px;
      background: #ffe6e9;
      border: 1px solid #ffb3b3;
      border-radius: 8px;
      padding: 10px;
    }
    .semestre h3 {
      text-align: center;
      color: #c2185b;
    }
    .ramo {
      background: #ffffff;
      border: 1px solid #ffcdd2;
      padding: 10px;
      margin: 6px 0;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
      position: relative;
    }
    .ramo.aprobado {
      background: #f8bbd0;
      text-decoration: line-through;
    }
    .ramo.bloqueado {
      background: #fce4ec;
      cursor: not-allowed;
      opacity: 0.6;
    }
    .tooltip {
      visibility: hidden;
      background-color: #d81b60;
      color: #fff;
      text-align: center;
      padding: 4px;
      border-radius: 4px;
      position: absolute;
      z-index: 1;
      top: 0;
      left: 100%;
      margin-left: 5px;
      white-space: nowrap;
      font-size: 12px;
    }
    .ramo:hover .tooltip {
      visibility: visible;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva Obstetricia y Puericultura - ULagos</h1>
  <div class="malla" id="malla"></div>

  <script>
    const ramos = [
      // Semestre 1
      { id: "comunicacion1", nombre: "Comunicación I", semestre: 1, prereq: [] },
      { id: "fundamentos", nombre: "Fundamentos de la Salud Sexual y Reproductiva", semestre: 1, prereq: [] },
      { id: "bases_biologicas", nombre: "Bases Biológicas en SSR", semestre: 1, prereq: [] },
      { id: "bases_bioquimicas", nombre: "Bases Bioquímicas en SSR", semestre: 1, prereq: [] },
      { id: "antropologia", nombre: "Antropología en SSR", semestre: 1, prereq: [] },

      // Semestre 2
      { id: "ciudadania1", nombre: "Ciudadanía I", semestre: 2, prereq: [] },
      { id: "bioestadistica", nombre: "Bioestadística", semestre: 2, prereq: [] },
      { id: "microbiologia", nombre: "Microbiología y Parasitología", semestre: 2, prereq: [] },
      { id: "anatomia", nombre: "Anatomía", semestre: 2, prereq: [] },
      { id: "fisiologia", nombre: "Fisiología e Histología", semestre: 2, prereq: ["bases_biologicas"] },
      { id: "enfermeria_basica", nombre: "Enfermería Básica", semestre: 2, prereq: [] },
      { id: "ufin2", nombre: "Electivo UFIN", semestre: 2, prereq: [] },

      // Semestre 3
      { id: "ingles1", nombre: "Inglés I", semestre: 3, prereq: [] },
      { id: "epidemiologia", nombre: "Epidemiología", semestre: 3, prereq: [] },
      { id: "psicologia", nombre: "Psicología", semestre: 3, prereq: [] },
      { id: "fisiopato_farma", nombre: "Fisiopatología y Farmacología", semestre: 3, prereq: ["fisiologia"] },
      { id: "bases_gine", nombre: "Bases Fisiológicas en Ginecología", semestre: 3, prereq: [] },
      { id: "proc_enf_ssr", nombre: "Proceso de Enfermería en SSR", semestre: 3, prereq: ["enfermeria_basica", "fisiologia"] },

      // Semestre 4
      { id: "ingles2", nombre: "Inglés II", semestre: 4, prereq: ["ingles1"] },
      { id: "bases_obst_neon", nombre: "Bases Fisiológicas en Obstetricia y Neonatología", semestre: 4, prereq: [] },
      { id: "patologia_gine", nombre: "Bases Patológicas en Ginecología", semestre: 4, prereq: ["bases_gine"] },
      { id: "salud_fam_com", nombre: "Salud Familiar y Comunitaria", semestre: 4, prereq: [] },
      { id: "proc_enf_gineco", nombre: "Proceso de Enfermería en la Gineco-Obstetricia", semestre: 4, prereq: ["proc_enf_ssr", "fisiopato_farma"] },
      { id: "ufin4", nombre: "Electivo UFIN", semestre: 4, prereq: [] },

      // Semestre 5
      { id: "ingles3", nombre: "Inglés III", semestre: 5, prereq: ["ingles2"] },
      { id: "gestion_ssr", nombre: "Introducción a la Gestión en SSR", semestre: 5, prereq: [] },
      { id: "patologia_obst_neon", nombre: "Bases Patológicas en Obstetricia y Neonatología", semestre: 5, prereq: ["bases_obst_neon", "fisiopato_farma"] },
      { id: "educacion_ssr", nombre: "Educación en SSR", semestre: 5, prereq: ["patologia_gine"] },
      { id: "salud_fam_aps", nombre: "Salud Familiar en APS", semestre: 5, prereq: ["salud_fam_com", "patologia_gine", "enfermeria_basica", "proc_enf_ssr", "proc_enf_gineco"] },

      // Semestre 6
      { id: "ingles4", nombre: "Inglés IV", semestre: 6, prereq: ["ingles3"] },
      { id: "metodologia", nombre: "Metodología de la Investigación", semestre: 6, prereq: [] },
      { id: "clinica_perinatal", nombre: "Clínica de Cuidados Perinatales", semestre: 6, prereq: ["patologia_obst_neon", "salud_fam_aps", "fisiopato_farma", "enfermeria_basica", "proc_enf_ssr", "proc_enf_gineco"] },
      { id: "ufin6", nombre: "Electivo UFIN", semestre: 6, prereq: [] },

      // Semestre 7
      { id: "seminario", nombre: "Seminario de Investigación", semestre: 7, prereq: ["metodologia"] },
      { id: "gine_onco", nombre: "Clínica Gine-oncológica", semestre: 7, prereq: ["patologia_gine", "salud_fam_aps", "fisiopato_farma", "enfermeria_basica", "proc_enf_ssr", "proc_enf_gineco"] },
      { id: "ufin7", nombre: "Farmacología aplicada en Ginecobstetricia", semestre: 7, prereq: [] },

      // Semestre 8
      { id: "ciudadania2", nombre: "Gestión de Proyectos (Ciudadanía II)", semestre: 8, prereq: [] },
      { id: "clinica_perinatal_pat", nombre: "Clínica Perinatal Patológica", semestre: 8, prereq: ["clinica_perinatal", "enfermeria_basica", "proc_enf_ssr", "proc_enf_gineco"] },
      { id: "ufin8", nombre: "Farmacología aplicada en Ginecobstetricia", semestre: 8, prereq: [] },

      // Semestre 9
      { id: "internado1", nombre: "Internado I", semestre: 9, prereq: r => r.filter(x => x.semestre < 9).map(x => x.id) },

      // Semestre 10
      { id: "internado2", nombre: "Internado II", semestre: 10, prereq: ["internado1"] },
      { id: "electivo_final", nombre: "Electivo Especialización/Articulación Postgrado", semestre: 10, prereq: ["internado2"] }
    ];

    const estado = JSON.parse(localStorage.getItem("malla_aprobadas") || "{}");
    const contenedor = document.getElementById("malla");

    for (let s = 1; s <= 10; s++) {
      const columna = document.createElement("div");
      columna.className = "semestre";
      columna.innerHTML = `<h3>Semestre ${s}</h3>`;
      ramos.filter(r => r.semestre === s).forEach(ramo => {
        const div = document.createElement("div");
        div.className = "ramo";
        div.textContent = ramo.nombre;

        const prereqList = typeof ramo.prereq === "function" ? ramo.prereq(ramos) : ramo.prereq;
        const faltan = prereqList.filter(id => !estado[id]);
        const aprobado = estado[ramo.id];

        if (aprobado) div.classList.add("aprobado");
        if (faltan.length > 0 && !aprobado) {
          div.classList.add("bloqueado");
          const tooltip = document.createElement("span");
          tooltip.className = "tooltip";
          tooltip.textContent = "Falta: " + faltan.map(id => ramos.find(r => r.id === id)?.nombre).join(", ");
          div.appendChild(tooltip);
        } else {
          div.addEventListener("click", () => {
            estado[ramo.id] = !estado[ramo.id];
            localStorage.setItem("malla_aprobadas", JSON.stringify(estado));
            location.reload();
          });
        }

        columna.appendChild(div);
      });
      contenedor.appendChild(columna);
    }
  </script>
</body>
</html>
